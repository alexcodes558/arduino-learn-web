<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Arduino Playground</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f0f0f0;}
.topbar{display:flex;justify-content:space-between;align-items:center;background:#1e1e1e;color:white;padding:12px 16px;font-weight:bold;font-size:20px;}
.topbar button{background:#2c7dc9;color:white;border:none;border-radius:6px;padding:6px 12px;cursor:pointer;font-size:14px;}
.topbar button:hover{background:#1b63a3;}
.workspace{display:flex;flex-wrap:wrap;height:calc(100vh - 48px);}
.board-area{flex:2;min-width:320px;padding:16px;position:relative;overflow:auto;background:#e8e8e8;}
.control-panel{flex:1;min-width:320px;padding:16px;background:#fff;border-left:3px solid #ccc;overflow:auto;}
.component{position:absolute;width:26px;height:26px;border-radius:4px;text-align:center;line-height:26px;cursor:grab;transition: all 0.2s ease;}
.led{background:red;border:2px solid #222;box-shadow:0 0 5px rgba(255,0,0,0.5);}
.led.on{box-shadow:0 0 12px red;}
.button{background:#ccc;border:2px solid #555;}
.button.pressed{background:#999;box-shadow:inset 0 0 5px #666;}
.resistor{background:brown;border:2px solid #222;}
.buzzer{background:black;border:2px solid #222;}
.motor{background:purple;border:2px solid #222;}
.wire{background:transparent;border:2px solid green;width:2px;}
.lightSensor{background:yellow;border:2px solid #222;}
.potentiometer{background:orange;border:2px solid #222;}
.ultrasonic{background:blue;border:2px solid #222;}
.pir{background:lime;border:2px solid #222;}
.slider{background:orange;border:2px solid #222;}
textarea{width:100%;height:140px;font-family: monospace;margin-bottom:10px;}
button{width:100%;padding:12px;font-size:16px;margin-top:10px;background:#2c7dc9;color:white;border:none;border-radius:6px;cursor:pointer;}
button:hover{background:#1b63a3;}
.status{margin-top:10px;font-weight:bold;}
svg{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:visible;}
.tooltip{position:absolute;background:#222;color:white;font-size:12px;padding:2px 6px;border-radius:4px;pointer-events:none;display:none;}
#arduino-img{position:absolute;top:0;left:0;width:260px;}
#breadboard-img{position:absolute;top:0;left:280px;width:700px;}
.pin{width:14px;height:14px;border-radius:50%;background:#666;position:absolute;cursor:pointer;}
.pin:hover{background:orange;}
</style>
</head>
<body>
<div class="topbar">
Ultimate Arduino Playground
<button id="modeBtn">Switch to Blank Circuit</button>
</div>
<div class="workspace">
<div class="board-area" id="board-area">
<svg id="wires-svg"></svg>
<img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" id="arduino-img" alt="Arduino UNO">
<img src="https://upload.wikimedia.org/wikipedia/commons/1/10/Breadboard.jpg" id="breadboard-img" alt="Breadboard">
</div>
<div class="control-panel">
<h3>Components</h3>
<button onclick="addComponent('led')">Add LED</button>
<button onclick="addComponent('button')">Add Button</button>
<button onclick="addComponent('resistor')">Add Resistor</button>
<button onclick="addComponent('buzzer')">Add Buzzer</button>
<button onclick="addComponent('motor')">Add Motor</button>
<button onclick="addComponent('wire')">Add Wire</button>
<button onclick="addComponent('lightSensor')">Add Light Sensor</button>
<button onclick="addComponent('potentiometer')">Add Potentiometer</button>
<button onclick="addComponent('ultrasonic')">Add Ultrasonic</button>
<button onclick="addComponent('pir')">Add PIR Sensor</button>
<h3>Arduino Code</h3>
<textarea id="code">// Example:
// int val = analogRead(A0);
// if(val > 500){ digitalWrite(D3,HIGH); } else { digitalWrite(D3,LOW); }</textarea>
<button onclick="runCode()">Run Simulation</button>
<h3>Project</h3>
<button onclick="saveProject()">Save Project</button>
<button onclick="loadProject()">Load Project</button>
<button onclick="exportProject()">Export JSON</button>
<input type="file" id="importFile" onchange="importProject(event)">
<h3>Lessons</h3>
<button onclick="prevLesson()">Previous Lesson</button>
<button onclick="nextLesson()">Next Lesson</button>
<span id="lesson-label">Lesson 1</span>
</div>
</div>
<script>
// VARIABLES
const boardArea=document.getElementById("board-area");
const svg=document.getElementById("wires-svg");
const components=[];
const wires=[];
let wireStart=null;
const status=document.getElementById("status");
let blankMode=false;

// MODE SWITCH
const modeBtn = document.getElementById("modeBtn");
modeBtn.addEventListener("click", ()=>{
blankMode=!blankMode;
if(blankMode){document.getElementById("arduino-img").style.display="none";document.getElementById("breadboard-img").style.display="none";modeBtn.textContent="Switch to Tinkercad Mode";}
else{document.getElementById("arduino-img").style.display="block";document.getElementById("breadboard-img").style.display="block";modeBtn.textContent="Switch to Blank Circuit";}
});

// PINS
const arduinoPins=[];
function createPins(){
const pinPositions = [
{type:'D0',x:20,y:40},{type:'D1',x:20,y:60},{type:'D2',x:20,y:80},{type:'D3',x:20,y:100},
{type:'D4',x:20,y:120},{type:'D5',x:20,y:140},{type:'D6',x:20,y:160},{type:'D7',x:20,y:180},
{type:'D8',x:20,y:200},{type:'D9',x:20,y:220},{type:'D10',x:20,y:240},{type:'D11',x:20,y:260},
{type:'D12',x:20,y:280},{type:'D13',x:20,y:300},
{type:'A0',x:240,y:40},{type:'A1',x:240,y:60},{type:'A2',x:240,y:80},{type:'A3',x:240,y:100},{type:'A4',x:240,y:120},{type:'A5',x:240,y:140},
{type:'GND',x:120,y:20},{type:'5V',x:140,y:20}
];
pinPositions.forEach(p=>{
const pin=document.createElement('div'); pin.className='pin';
pin.style.left=p.x+'px'; pin.style.top=p.y+'px';
boardArea.appendChild(pin);
arduinoPins.push({type:p.type,element:pin,connections:[]});
});
}
createPins();

// ADD COMPONENT
function addComponent(type){
const el=document.createElement("div"); el.className="component "+type; el.textContent=type[0].toUpperCase();
el.style.left="300px"; el.style.top="100px"; boardArea.appendChild(el);
components.push({type,element:el,value:0});
// DRAGGING
el.onmousedown=function(e){
let offsetX=e.offsetX, offsetY=e.offsetY;
function move(ev){
let x=ev.clientX-boardArea.getBoundingClientRect().left-offsetX;
let y=ev.clientY-boardArea.getBoundingClientRect().top-offsetY;
el.style.left=x+"px";el.style.top=y+"px"; updateWires();}
function up(){document.removeEventListener("mousemove",move);document.removeEventListener("mouseup",up);}
document.addEventListener("mousemove",move);document.addEventListener("mouseup",up);};
// SENSORS
if(type=="lightSensor"||type=="potentiometer"||type=="ultrasonic"){
const slider=document.createElement("input"); slider.type="range"; slider.min="0"; slider.max="1023"; slider.value="512";
slider.style.position="absolute"; slider.style.width="80px"; slider.style.top="30px"; slider.style.left="-27px";
slider.oninput=()=>{components.find(c=>c.element===el).value=parseInt(slider.value); runCode();}; el.appendChild(slider);}
if(type=="pir"){el.onclick=()=>{components.find(c=>c.element===el).value^=1; runCode();}; el.textContent="P";}
}

// WIRES
function startWire(pin){wireStart=pin; status.textContent="Click component to connect wire";}
function updateWires(){
svg.innerHTML="";
wires.forEach(w=>{
const {from,to}=w;
const f={left:parseInt(from.element.style.left),top:parseInt(from.element.style.top),width:26,height:26};
const t={left:parseInt(to.element.style.left),top:parseInt(to.element.style.top),width:26,height:26};
const x1=f.left+f.width/2, y1=f.top+f.height/2;
const x2=t.left+t.width/2, y2=t.top+t.height/2;
const path=document.createElementNS("http://www.w3.org/2000/svg","path");
path.setAttribute("d",`M${x1},${y1} C${x1},${y1+50} ${x2},${y2-50} ${x2},${y2}`);
path.setAttribute("stroke","green"); path.setAttribute("stroke-width","3"); path.setAttribute("fill","none"); svg.appendChild(path);
});}

// RUN CODE
function runCode(){
components.forEach(c=>{if(c.type=="led")c.element.classList.remove("on");});
const lines=document.getElementById("code").value.split("\n");
lines.forEach(l=>{
const digitalMatch=l.match(/digitalWrite\((D\d+),\s*(HIGH|LOW)\)/);
if(digitalMatch){const pin=digitalMatch[1]; const val=digitalMatch[2];
components.forEach(c=>{if(c.type=="led"){if(val=="HIGH")c.element.classList.add("on"); else c.element.classList.remove("on");}});}
});
status.textContent="Simulation run!";}

// LESSONS
let currentLesson=1,totalLessons=10; const lessonsKey="arduinoCourseLessons";
if(!localStorage.getItem(lessonsKey)){let e={};for(let i=1;i<=totalLessons;i++) e["lesson"+i]=null; localStorage.setItem(lessonsKey,JSON.stringify(e));}
function saveProject(){const p={components:components.map(c=>({type:c.type,x:c.element.style.left,y:c.element.style.top,value:c.value})),code:document.getElementById("code").value};
let l=JSON.parse(localStorage.getItem(lessonsKey)); l["lesson"+currentLesson]=p; localStorage.setItem(lessonsKey,JSON.stringify(l)); status.textContent=`Lesson ${currentLesson} saved!`;}
function loadProject(){let l=JSON.parse(localStorage.getItem(lessonsKey)); let p=l["lesson"+currentLesson]; if(!p){status.textContent=`Lesson ${currentLesson} empty.`; return;} components.forEach(c=>c.element.remove()); components.length=0;
p.components.forEach(c=>{addComponent(c.type); const comp=components[components.length-1]; comp.element.style.left=c.x; comp.element.style.top=c.y; comp.value=c.value;});
document.getElementById("code").value=p.code; document.getElementById("lesson-label").textContent=`Lesson ${currentLesson}`; status.textContent=`Lesson ${currentLesson} loaded!`;}
function nextLesson(){saveProject(); if(currentLesson<totalLessons) currentLesson++; loadProject();}
function prevLesson(){saveProject(); if(currentLesson>1) currentLesson--; loadProject();}
function exportProject(){saveProject(); const l=localStorage.getItem(lessonsKey); const b=new Blob([l],{type:"application/json"}); const url=URL.createObjectURL(b);
const a=document.createElement("a"); a.href=url; a.download="arduino_course.json"; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); status.textContent="Course exported!";}
function importProject(e){const f=e.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=function(ev){localStorage.setItem(lessonsKey,ev.target.result); loadProject();}; r.readAsText(f);}
loadProject();
</script>
</body>
</html>
